---
title: 51单片机
date: 2023-07-26 15:26:47
tags:
  - 51单片机
published: False
---

忆回飞花落叶时，梦转蓦然回首间

<!--more-->

# 51 单片机

## 认识 51 单片机

### 什么是单片机

- 单板机：将 CPU 芯片、储存器芯片、I/O 接口芯片和简单的 I/O 设备（小键盘、LED 显示器）等装配在一块印刷的电路班上，再配上监控程序（固话在 ROM 中），就构成了一台单板微信计算机（简称单板机）
- 单片机：在一片集成电路芯片上集成微处理器、存储器、I/O 接口电路，从而构成但芯片微型计算机，即单片机。

### 预备知识

- 数字电路中只有两种电平：高和低
- 二进制：数字电路中的两种电平特性决定
- 十六进制：熟练掌握二进制与十六进制间的转换，一般把四个二进制数放在一起转换成一个十六进制数，转换时先把二进制数转换成十进制数，再把十进制数转换成十六进制数。
  B 表示为二进制，H 为十六进制：1001B->9->9H; 0010 1100->44->2CH
- 二进制数的逻辑运算：

  - 与运算：同 1 得 1
  - 或运算：有 1 出 1
  - 非运算：1 变 0，0 变 1
  - 与或运算：相同为 0，不同为 1

- 单片机的组成：

  - CPU：由运算和控制逻辑组成，同时还包括中断系统和部分外部特殊功能寄存器
  - RAM：用以存放可以读写的数据，如运算的中间结果、最终结果以及欲显示的数据
  - ROM：用于存放程序、一些原始数据和表格
  - I/O：四个 8 位并行 I/O 口，既用作输入，也可用作输出
  - T/C：两个定时/计数器，既可以工作在定时模式，也可以工作在记数模式
  - 五个中断

- C-51 的数据类型
  | 类型 | 符号 | 关键字 | 所占位数 | 数的表示范围 |
  | ---- | ---- | -- | - | - |
  | 整型 | 有 | (signed)int | 16 | -32768~32767 |
  | 整型 | 有 | (signed)short | 16 | -32768~32767 |
  | 整型 | 有 | (signed)long | 32 | -2$^{31}$~2$^{31}$-1 |
  | 整型 | 无 | unsigned int | 16 | 0~2$^{16}$-1 |
  | 整型 | 无 | unsigned short int | 16 | 0~2$^{16}$-1 |
  | 整型 | 无 | unsigned long int | 32 | 0~2$^{32}$-1 |
  | 实型| 有 | float | 32 | -3.4e$^{-38}$~3.4e$^{38}$ |
  | 实型 | 有 | double | 64 | -1.7e$^{-308}$~1.7e$^{308}$ |
  | 字符型 | 有 | char | 8 | -128~127 |
  | 字符型 | 无 | unsigned char | 8 | 0~255 |

- C-51 的数据类型扩充定义
  - sfr:特殊功能寄存器声明
  - sfr16：sfr 的 16 位数据声明
  - sbit：特殊功能位声明
  - bit：位变量声明
  ```C
    sfr SCON = 0X98; // 定义了个寄存器
    sfr16 T2 = 0xCC; // 同上
    sbit OV = PSW^2; // 表示 PSW 寄存器的第二位定义为 OV
  ```
- C-51 数据的存储类型

  ```C
    char var1;
    bit flags;
    unsigned char vextor[10];
    int wwww;
  ```

- C-51 中常用的头文件

  - 通常：`reg51.h` `reg52.h` `math.h` `ctype.h` `stdio.h` `stdlib.h` `absacc.h`
  - 常用：`reg51.h` `reg52.h`(定义特殊功能寄存器和位寄存器) math.h(定义常用数学运算)

- C-51 的基本语句

  - `if` `while` `for` `switch/case` `do-while`
  - 中断服务程序：函数名() interrupt n using m{ 函数内部实现 }
  - I/O 口定义：sbit beep=P2^3;

- 单片机主要掌握以下几点
  - 最小系统能够运行起来的必要条件
    - 电源
    - 晶振
    - 复位电路
  - 对单片机任意 I/O 口的随意操作
    - 输出控制电平高低
    - 输入检测电平高低
  - 定时器：重点掌握最常用的方式 2
  - 中断：外部中断、定时器中断、串口中断
  - 串口通信：单片机之间、单片机与计算机间

## 熟悉逻辑运算

## 点亮 LED 灯

```C
  // 位操作点亮发光二极管
  #include <reg52.h> // 定义寄存器地址的头文件
  sbit D1=P1^0; // p1 的第一个管脚
  void main(int argc, const char *argv[])
  {
    D1=0;
  }
```

```C
  // 总线操作点亮发光二极管
  #include <REG52.H>
  void main
  {
    P1=0xfb;  // 直接按16进制操作对应 1011 1111
  }
```

## 中断

- 中断概念：中断是单片机具有对外部或内部随机发生时间实时处理而设置的。优点：分时操作、实时响应、可靠性高
- 中断结构
  []()
- 中断寄存器
- 外部中断实验
  - 外部中断介绍
  - 外部中断配置
  - 硬件设计/软件编程

## 定时器

- CPU 时序周期相关知识
- 定时器原理
- 定时计数器结构
- 定时计数器工作方式
- 定时计数器配置
- 硬件设计/软件编程

## 串口通信

- 串口通信与并口通信
  - 串行通信-->依次传输
  - 并行通信-->同时传输
- 异步通信与同步通信
  - 异步通信：发出设备和接收设备使用各自的时钟，各字符间有整数倍间隔。一个字符帧包含 11 位。
  - 同步通信：发送和接收时钟同步，外同步：发送时钟控制接收；自同步：数据+时钟控制接收。
- 单工&半双工&全双工通信
  - 单工：单向方向
  - 半双工：分时发送接收
  - 全双工：可同时发送和接收
- 通信数率(bit/s)
  - 波特率（每秒多少码元）；比特率（每秒多少位）bps
- 串口通信简介
  - 接口标准和通信协议
    - 接口标准
    - 通信协议：RS232 遵循`96-N-8-1`：{`96`：9600, `N`:无校验位，`8`：传输的数据位，`1`：停止位}
  - 串口内部结构
  - 串口相关寄存器
  - 串口工作方式：
    - 方式 1
    - 方式 2
    - 方式 3
  - 计算波特率
  - 串口配置步骤
  - 硬件设计/软件编程

## $I^{2}C$-EEPROM 协议

- $I^{2}C$ 物理层介绍
- $I^{2}C$ 协议层
  - 起始和停止信号
  - 应答信号
  - 总线寻址方式
  - 数据传输
- AT24C02 介绍
- 硬件介绍
- 软件介绍
  - 创建多文件工程
  - $I^{2}C$ 起始和停止信号
  - $I^{2}C$ 等待应答信号
  - $I^{2}C$ 读写字节函数
    - 写字节函数
    - 读字节函数
    - 主函数

## AD 数模转换器

- ADC 数模转换
  - ADC 简介
  - ADC 转换步骤
  - ADC 转换原理
    - 逐次逼近型
    - 双积分型
  - XPT2046 芯片功能介绍
  - 硬件设计
  - 软件编程
    - 写函数
    - 读函数
    - 读 AD 转换数据函数
    - 主函数
- DAC 数模转换
  - DAC 简介
  - DAC 工作原理
  - PWM 介绍
  - 主函数

## 参考文献

## 补充

### 原理图相关

- 管脚名相同则相连
- 排阻：阻值的选取，通过发光二极管选择(3mA~10mA)
- 锁存器：
