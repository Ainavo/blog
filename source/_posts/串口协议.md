---
title: 串口协议
date: 2023-09-05 09:17:51
tags:
  - 嵌入式
---

常见的一些串口协议总结~

<!--more-->

## $I^2C$(Inter-Integrated Crircuit) 通讯协议

![I^2C](\imgs\串口通信\I^2C.jpg)

- SCL(时钟线)
- SDA(数据线)
- 上升沿采样
- 半双工通信
- 时钟信号为高电平，起始位通过下降沿触发
- 传输数据时：时钟线为高时，数据线上的数据要保持稳定
- 读数据帧
  ![I^2C读数据帧](\imgs\串口通信\I^2C读数据帧.jpg)
  - `S`：起始位
  - `设备地址`:7 位
  - `写数据`：0
  - `应答信号`：0 表示成功
  - `寄存器地址`：8 位
  - `设备地址`：7 位（二次发送）
  - `读数据`：1
  - `要接受的数据`：8 位
  - `应答信号`:1
  - `P`:停止位
- ![I^2C写数据帧](\imgs\串口通信\I^2C写数据帧.jpg)
  - `S`：起始位
  - `设备地址`：7 位
  - `写数据`：0
  - `应答信号`：0 表示成功
  - `8位寄存器`
  - `应答信号`：0 表示成功
  - `写入的数据`:8 位
  - `应答信号`：0 表示成功
  - `P`：停止位

## SPI(Serial Peripheral Interface) 通讯协议

![SPI](\imgs\串口通信\SPI.jpg)

- 一主多从模式
- `SS`:片选信号线，低电平有效（具体看手册）
- `SCK`:时钟信号线
- `MOSI`:发送信号线(主发)
- `MISO`:接受信号线(主收)
  | 指令 | 起始位 | 操作码 | 地址 | 数据 |
  | -----| ---- | ---- | ---- | ----- |
  | 写数据 | 1 | 01 | 7 位 | 8 位 |
  | 读数据 | 1 | 10 | 7 位 | |

## CAN(Controller Area Network) 通讯协议

![CAN](\imgs\串口通信\CAN.jpg)

- 差分信号通信：抗干扰贼强
  ![CAN](\imgs\串口通信\CAN.jpg)
- 标准数据帧：
  - `起始位`
  - `识别码`
  - `RTR位`
  - `IDE位`
  - `空闲位`
  - `DLC`(3 位):控制数据长度：8~64
  - `CRC`(16 位):循环冗余校验位
  - `CRC界定符`：隔绝后面信息
  - `ACK码`：
    - ACK 确认槽：发送端发送逻辑 1，接收端回复逻辑 0 来应答
    - ACK 界定位：指定逻辑 1，隔开数据
  - `结束位`：7 个 1
- 优先级：看识别码，先有逻辑 0 的优先

<!-- ## UART 通信协议（异步通信） -->
