---
title: HS-CNN
date: 2022-09-17 10:10:12
categories: "MI"
tags:
  - MI
  - Top-accuracy
---

<HS-CNN：用于脑电图运动图像分类的具有混合卷积尺度的 CNN>

<!--more-->

## **Abstract**

本文提出了一种混合尺度的 CNN 架构，具有用于 EEG 运动图像分类的数据增强方法，在 BCI08 2a/2b 数据集上分别取得了 91.57% 和 87.6%的准确率(这准确率也太高了)。

## **Method**

![图1.HS-CNN网络框架](/imgs/HS-CNN/HS-CNN%20网络框架.png)

$A.Proposed\ HS-CNN \ Structure$  
 如图 2 显示了具有不同内核大小的两个不同测试对象的分类精度。可以看出，主题 A 的最佳内核大小为 1×115，而主题 B 的最佳内核大小为 1×55。此外，对于同一个主题 A，会话 1 和会话 2 的最佳内核大小分别为 1×105 和 1×65。它们表明最佳内核大小因主题而异，对于同一主题，最佳内核大小不时变化。受这一发现的启发，本文作者提出了一种具有混合卷积尺度的 CNN（称为 HS-CNN）来提高分类精度。
![图2.不同尺度卷积核对准确率的影响](/imgs/HS-CNN/不同卷积核对应准确率.png)
图 1 显示了 HS-CNN 架构。早期的工作已经表明，运动想象任务将导致 $mu$ 和 $beta$ 频带（8-32 Hz）中的去同步（ERD）和同步（ERS）现象。近年来，一些工作表明，$theta$ 波段（4-7 Hz）在运动想象任务中也起着至关重要的作用，因为左手/右手运动想象任务之间的 $theta$ 波段 ERD 显着不同。因此，作者选择了 $theta$ 频段（4-7 Hz）、$mu$ 频段（8-13 Hz）和 $beta$ 频段（13-32 Hz）进行信号**滤波**，为后续分类获取足够的信息。如图 1 所示，在卷积核为 (1×45, 1×65 and 1×85) 的情况下，模型准确率较高(>84%)，因此作者选择了这三个卷积核来提取**时域信息**。然后，对于每个内核大小的分支，使用沿垂直轴的一维内核来提取**空间域信息**。通过这种方式，提取了具有不同卷积尺度的不同域（时间、频率和空间）的脑电信息。对于特征融合，在 Flatten 层中，通过将 2D 特征中的行连接成 1D 向量来将 2D 特征映射到 1D 特征。这对所有九个分支都完成了（频域 3 个、时域 3 个）。然后，在 Flatten 层之后，将来自 9 个分支的所有 1D 特征连接成一个 1D 向量，并将该向量用作全连接层的输入。所提出的网络使用中提出的指数线性单元（ELU）作为**激活函数**，因为它能够加速神经网络中的学习并提高分类精度。为了防止过拟合，使用了 **L2 正则化**和 dropout 技术。表 1 给出了所提出的 HS-CNN 架构的详细参数。

![表1.HS-CNN 的详细参数](/imgs/HS-CNN/本文所用CNN的参数.png)

$B.Data Augmentation$  
 为了解决数据量不足的问题，过去提出了两种类型的数据增强方法。其中之一是执行数据转换以从原始训练数据中生成更多的训练数据。另一种是在原始训练数据中添加噪声以生成新的训练数据。但是，分类精度的提高是有限的。本文提出了一种新的数据增强方法，可以在真实训练数据的基础上生成人工训练数据，以提高分类精度。数据增强（分割重组）分三个阶段：

$1).Segmentation$(分割)  
 首先对具有相同标签的输入试验（即左/右手运动图像）进行分割。每个试验分为 3 个部分。由于试验时长为 875 个采样点，不能精确划分，因此长度分别为 292、292、291（这里主要是针对每次想象的长度，一个 trial 会包含多次想象）

$2).Time-Domain Recombination$(时域重组)  
 重新组合具有相同标签的作物以产生新的试验。对于**同一个人、同一类**，来自多个试验的相同位置的作物被随机交换和重组，以生成重组试验。

$3).Frequency-Domain Swapping$(频域交换)  
 在带通滤波之后，相同频带的滤波试验（来自**同一人和同一类**）被随机交换以形成新的滤波试验。例如，如图 3 所示，第 X 次试验的第 3 个频带可以与第 Y 次试验的 3 个频带交换。在这项工作中，重复 2）和 3）多次，以生成原始数据的 3 倍训练数据。![图3.数据增强的方法](/imgs/HS-CNN/数据增强的方法.png)

## **Experimental Results**

$A.Dataset \ and \ Experimental Method$
在本项工作中，使用了 BCI 竞赛 IV 2a 和 2b 数据集用于评估。BCIIV 2a 从 9 名健康受试者收集 EEG 数据。对于每个受试者，收集了 2 次数据。每次有 288 次试验。试验总数为 5184。BCIIV 2b 从另外 9 名健康受试者收集 EEG 数据。对于每个受试者，收集了 5 次数据。前 2 个 block 中的每一个都有 120 次试验，后 3 个 block 中每一个有 160 次试验。试验总数为 6520。这些数据集中包括两种类型的试验：左手运动和右手运动。EEG 数据由三个电极（C3、CZ、C4）收集，电极按照国际 10-20 系统放置，试验的时间范围为 3.5s 至 7s。因此，试验是一个 3×875 矩阵（这只针对 2b 数据集）。**实验参数**：在本次的实验中，droprate 设置为 0.8（这个有点高吧，是指保留 0.8 吗？），L2 正则化参数设置为 0.01。选用随机梯度下降（SGD）优化。初始学习率设置为 0.1，学习率每 10 个周期（训练 400 个周期）衰减一次，指数衰减率为 0.9。

$B.Performance \ of \ the \ proposed \ HS-CNN$
为了评估所提出的 HS-CNN 的性能，在 HS-CNN 和具有单卷积尺度的 CNN 之间进行了比较实验。基线 CNN 的设计遵循了经常引用的运动图像分类方法。该方法在现有方法中具有较高的分类精度。基线 CNN 的架构如表 2 所示。由于中的原始 CNN 架构有 44 个输入通道和 4 个分类输出，作者对其进行了轻微修改，以适应本文的情况（即 3 个输入通道，2 个分类输出）。为了公平比较，HS-CNN 使用与基线 CNN 几乎相同数量的参数（略少），如表 1 和表 2 所示。为了评估核大小对分类精度的影响，作者还将基线 CNN 中第一卷积层的核大小从 1×45 更改为其他大小（1×10 和 1×95 之间的不同大小）。结果如图 4 所示。与单卷积尺度的 CNN 相比，所提出的混合卷积尺度 HS-CNN 具有更高的精度。
![表2.基线CNN的详细参数](/imgs/HS-CNN/基线CNN详细参数.png)
![图4.与单一卷积核的比较](/imgs/HS-CNN/与单一卷积核的比较.png)
作者还对比了几个脑电领域较为常用的算法：EEGNet、ShallowNet、DeepNet 在 BCIIV 2b 数据集上的准确率，如图 5 所示。
![图5.与EEGNet等算法比较](/imgs/HS-CNN/与EEGNet等比较.png)

$C.Performance \ of \ the \ proposed \ data \ augmentation \ method$
与不同数据增强结果比较图 6 所示，暂不详述。
![图6.不同数据增强方法比较](/imgs/HS-CNN/不同数据增强方法比较.png)

## **Conclusion**

![图7.实验结果](/imgs/HS-CNN/实验结果.png)（有个疑问，本文使用的 2a 数据集是将四分类任务转变为二分类了？）

现有的基于 CNN 的 EEG 运动图像分类方法使用 CNN 层中的单卷积尺度来提取 EEG 特征。这导致分类精度有限，因为最佳卷积尺度可能因受试者而异，或因同一受试者而不同。另一个问题是，由于训练数据有限，分类精度通常较低。在这项工作中，我们提出了一种混合尺度的 CNN 结构和数据增强方法，以提高 EEG 运动图像分类的准确性。对于 2008 年 BCI 竞赛 IV 2a 数据集，如图 7 所示，所提出的 EEG 运动图像分类方法实现了 91.57%的平均分类准确率。与几种最先进的方法相比，改进率从 11.64%提高到 23.25%。对于 2008 年 BCI Competition IV 2b 数据集，该方法的平均分类准确率为 87.6%，改进率从 2.9%提高到 19.7%。
