---
title: 操作系统（马士兵）
date: 2023-05-19 19:30:26
tags:
  - C++
  - 操作系统
---

**目录：**

- 什么是操作系统？
- 操作系统有哪些功能？
- 操作系统有哪些特征？
- 操作系统是怎么发展过来的？
- 操作系统的运行机制？
- 操作系统的结构是怎样设计的？

<!--more-->

# 操作系统的基本概念

## 操作系统定义

操作系统（Operation System），简称 OS，是管理计算机硬件和软件的计算机**程序**。
计算机系统构成：

- 用户:操作系统向用户提供的一些访问方式称作接口。
- 应用程序
- 操作系统（OS）
- 裸机

OS 是一种系统软件：

- 与硬件交互
- 对资源共享进行调度管理
- 解决并发操作处理中存在的协调问题
- 数据结构复杂，外部接口多样化，便于用户反复使用

## 操作系统的功能

- 目标：

  - 有效性
  - 提高系统资源利用率
  - 提高系统吞吐量
  - 方便性
  - 可扩充性
  - 开放性

- 功能：

  - 作为计算机系统资源的管理者
  - 处理机管理（CPU）：
    - 进程控制
    - 进程同步
    - 进程通信
    - 调度
  - 处理器管理
    - 内存分配
    - 内存保护
    - 地址映射
    - 内存扩充
  - I/O 设备管理
    - 缓冲管理
    - 设备分配
    - 设备处理
  - 文件管理
    - 文件存储空间管理
    - 目录管理
    - 文件的读/写管理和保护
  - 作为用户和计算机硬件系统间的接口
  - 程序接口：可以调用 os 上的一些服务，用于控制访问硬件
  - 命令接口：用户可以直接访问\操作 os，类似命令行
  - GUI（Graphical User Interface）图形用户接口
  - 实现对计算机资源的抽象
  - 将具体的计算机硬件资源抽象成软件资源，便于用户使用
  - 开放了简单的访问方式，隐藏了实现细节

## 操作系统的特征

- **并发**（相似概念：并行--同一**时刻**调度能力（CPU 核数））
  - 同一时间间隔内执行和调度多个程序的能力
    - 宏观上，处理机同时执行多道程序
    - 微观上，处理机在多道程序间高速切换（分时交替执行）
    - 关注单个处理机统一时间段内处理任务数量的能力
- 共享
  - 即资源共享，系统中的资源供多个并发执行的应用程序共同使用
    - 同时访问方式：同一时段允许多个程序同时访问共享资源
    - 互斥共享方式：也叫独占式，允许多个程序在同一个共享资源上独立而互不干扰的工作
    - 共享打印机、音频设备、视频设备....
  - 共享和并发互为存在条件
    - 共享性要求 OS 中同时运行多个程序
    - 若只有单个程序正在运行，则不存在共享的可能
    - 并发性难以避免的导致多个程序同时访问同一个资源
    - 若多个程序无法共享部分资源（比如磁盘），则无法并发
- 虚拟（Virtual）：使用某种技术把一个物理实体变成多个逻辑上的对应物
  - 时分复用技术（TDM，Time Division Multiplexing）
    - 虚拟处理机技术："四核八线程"
    - 虚拟设备技术：虚拟打印机
  - 空分复用技术（SDM，Space Division Multiplexing）
    - 虚拟磁盘技术：将一块硬盘虚拟出若干个卷
    - 虚拟存储器技术
- 异步（Asynchronism）
  - 多道程序环境下，允许多个程序并发执行；
  - 单处理机环境下，多个程序分时交替执行；
  - 程序执行的不可预知性
    - 获得运行的时机
    - 因何而停
    - 每道程序需要多少时间
    - 不同程序的性能，比如计算多少、I/O 多少
  - 宏观上"一气呵成"，微观上"走走停停"

# 操作系统发展和分类

## 分时操作系统

（一台主机连接多个外设，同时允许多个用户通过自己的终端，以交互的方式使用计算机，共享主机中的资源）

- 为什么需要时分系统？
  - 人机交互
  - 共享主机
  - 便于用户上网
- 关键问题

  - 及时接受
  - 及时处理（数据提前进入内存，并能够与用户交互）

- 分时系统的特征
  - 多路性：时间片轮转机制
  - 独立性：用户彼此独立
  - 及时性：用户能在段时间内获取响应
  - 交互性：用户可以请求多种服务
  - 分时系统的缺点
    - 作业/用户优先级相同，不能优先处理紧急任务
- 实时操作系统（能实时响应外部事件的请求，在规定时间内完成对该事件的处理，并控制多有实时任务协调一致）
  - 应用需求
    - 实时控制
    - 实时信息处理
  - 实时任务
    - 周期/非周期性实时任务（根据周期性）
    - 硬/软实时任务（根据截止时间）
- 微机操作系统
  - 单用户单任务
    - CP/M\MS-DOS
    - 单用户多任务
    - Windows 1.0 - XP
  - 多用户多任务
    - UNIX OS：Solaris、Linux、Mac
    - MS-DOS:Windows 10

# 操作系统的运行环境

- 时钟管理
  - 计时：提供系统时间
  - 时钟中断：切换进程
- **中断机制**
  - 提高多道程序环境下 CPU 利用率
  - 外中断：中断信号来源->外部设备
  - 内终端：中断信号来源->当前指令
    - 陷阱/陷入（Trap）：由应用程序主动引发
    - 故障（fault）：由错误条件引发
    - 终止（abort）：由致命错误引发
  - 中断的处理过程：
    - 关中断（CPU 不响应高级中断请求）
    - 保存断点（程序计数器（PC））
    - 引出中断服务
    - 保存现场和屏蔽字
    - 开中断
    - 执行终端服务
    - 关中断
    - 恢复现场和屏蔽字（现场：PSWR 和通用寄存器内容）
    - 开中断
- 原语
  - 由若干条指令组成
  - 用来完成某个特定功能
  - 执行过程不会被中断
- 系统数据与结构
  - 进程管理：作业控制快、进程控制快
  - 存储器管理：存储器分配与回收
  - 设备管理：缓冲区、设备控制块
- 系统调用
  - 有操作系统实现，给应用程序调用
  - 一套接口的集合
  - 应用程序访问内核服务的方式

# 微内核 OS 结构

- 微内核基本概念
- 足够小的内核，只实现 OS 的核心功能
  - 与硬件处理紧密相关的部分，比如硬件处理、客户与服务器的通信和其他基本功能
  - 一些较基本的功能
  - 客户与服务器之间的通信（客户/服务器模式）
- 应用"机制与策略分离原理"
- 采用面向对象技术
- 微内核的 OS 的优缺点：
  - 优点
    - 提高 OS 的可扩展性、可靠性、可移植性
    - 支持分布式系统
    - 融入了面向对象技术
  - 缺点
    - 相对于早期的 OS，降低了一定的效率

# **进程管理**

## 什么是进程？（P34）

- 进程的概念：process，是一个具有一定独立功能的程序关于某个数据集合的一次运行活动，是系统进行资源分配和调度的一个独立单位
  - 进程是程序的一次执行
  - 进程是一个程序及其数据在处理机上的顺序执行时多发生的活动
  - 进程是程序在一个数据集合上运行的过程
  - 进程是系统进行资源分配和调度的一个独立单位（基本单位）
- 进程的结构和特征
  - 结构
    - **控制块（PCB）**：process control block 进程唯一标识
    - 数据段：数据段，存放原始数据、中间数据
    - 程序段：存放在文本区域，可被多个进程共享
  - 特征
    - 动态性：由创建而生，由撤销而忘
    - 并发性：多个进程同时运行
    - 独立性：独立资源分配
    - 异步性：互相独立、互不干扰

## 线程

- 什么是线程？
  -Thread，进程的轻型实体，也叫"轻量级进程"，是一系列活动按实现设定好的顺序依次执行的过程，是一系列指令的集合
